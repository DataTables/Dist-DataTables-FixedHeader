/*!
 FixedHeader 3.1.0-dev
 Â©2009-2015 SpryMedia Ltd - datatables.net/license
*/
(function(d){"function"===typeof define&&define.amd?define(["jquery","datatables.net"],d):"object"===typeof exports?module.exports=function(g){g||(g=require("jquery"));g.fn.dataTable||require("datatables.net")(g);d(g)}:d(jQuery)})(function(d){var g=d.fn.dataTable,i=0,h=function(b,a){if(!(this instanceof h))throw"FixedHeader must be initialised with the 'new' keyword.";!0===a&&(a={});b=new g.Api(b);this.c=d.extend(!0,{},h.defaults,a);this.s={dt:b,position:{theadTop:0,tbodyTop:0,tfootTop:0,tfootBottom:0,
width:0,left:0,tfootHeight:0,theadHeight:0,windowHeight:d(window).height(),visible:!0},headerMode:null,footerMode:null,autoWidth:b.settings()[0].oFeatures.bAutoWidth,namespace:".dtfc"+i++,scrollLeft:{header:-1,footer:-1},enable:!0};this.dom={floatingHeader:null,thead:d(b.table().header()),tbody:d(b.table().body()),tfoot:d(b.table().footer()),header:{host:null,floating:null,placeholder:null},footer:{host:null,floating:null,placeholder:null}};this.dom.header.host=this.dom.thead.parent();this.dom.footer.host=
this.dom.tfoot.parent();var e=b.settings()[0];if(e._fixedHeader)throw"FixedHeader already initialised on table "+e.nTable.id;e._fixedHeader=this;this._constructor()};d.extend(h.prototype,{enable:function(b){this.s.enable=b;this.c.header&&this._modeChange("in-place","header",!0);this.c.footer&&this.dom.tfoot.length&&this._modeChange("in-place","footer",!0);this.update()},headerOffset:function(b){void 0!==b&&(this.c.headerOffset=b,this.update());return this.c.headerOffset},footerOffset:function(b){void 0!==
b&&(this.c.footerOffset=b,this.update());return this.c.footerOffset},update:function(){this._positions();this._scroll(!0)},_constructor:function(){var b=this,a=this.s.dt;d(window).on("scroll"+this.s.namespace,function(){b._scroll()}).on("resize"+this.s.namespace,function(){b.s.position.windowHeight=d(window).height();b.update()});a.on("column-reorder.dt.dtfc column-visibility.dt.dtfc draw.dt.dtfc",function(){b.update()});a.on("destroy.dtfc",function(){a.off(".dtfc");d(window).off(b.s.namespace)});
this._positions();this._scroll()},_clone:function(b,a){var e=this.s.dt,c=this.dom[b],f="header"===b?this.dom.thead:this.dom.tfoot;!a&&c.floating?c.floating.removeClass("fixedHeader-floating fixedHeader-locked"):(c.floating&&(c.placeholder.remove(),c.floating.children().detach(),c.floating.remove()),c.floating=d(e.table().node().cloneNode(!1)).removeAttr("id").append(f).appendTo("body"),c.placeholder=f.clone(!1),c.host.append(c.placeholder),this._matchWidths(c.placeholder,c.floating))},_matchWidths:function(b,
a){var e=function(c){var f=d(c,b).map(function(){return d(this).width()}).toArray();d(c,a).each(function(a){d(this).width(f[a]).css("min-width",f[a])})};e("th");e("td")},_unsize:function(b){var a=this.dom[b].floating;a&&("footer"===b||"header"===b&&!this.s.autoWidth)&&d("th, td",a).css("width","")},_horizontal:function(b,a){var e=this.dom[b],c=this.s.position,f=this.s.scrollLeft;e.floating&&f[b]!==a&&(e.floating.css("left",c.left-a),f[b]=a)},_modeChange:function(b,a,e){var c=this.dom[a],f=this.s.position;
if("in-place"===b){if(c.placeholder&&(c.placeholder.remove(),c.placeholder=null),this._unsize(a),c.host.append("header"===a?this.dom.thead:this.dom.tfoot),c.floating)c.floating.remove(),c.floating=null}else"in"===b?(this._clone(a,e),c.floating.addClass("fixedHeader-floating").css("header"===a?"top":"bottom",this.c[a+"Offset"]).css("left",f.left+"px").css("width",f.width+"px"),"footer"===a&&c.floating.css("top","")):"below"===b?(this._clone(a,e),c.floating.addClass("fixedHeader-locked").css("top",
f.tfootTop-f.theadHeight).css("left",f.left+"px").css("width",f.width+"px")):"above"===b&&(this._clone(a,e),c.floating.addClass("fixedHeader-locked").css("top",f.tbodyTop).css("left",f.left+"px").css("width",f.width+"px"));this.s.scrollLeft.header=-1;this.s.scrollLeft.footer=-1;this.s[a+"Mode"]=b},_positions:function(){var b=this.s.dt.table(),a=this.s.position,e=this.dom,b=d(b.node()),c=b.children("thead"),f=b.children("tfoot"),e=e.tbody;a.visible=b.is(":visible");a.width=b.outerWidth();a.left=b.offset().left;
a.theadTop=c.offset().top;a.tbodyTop=e.offset().top;a.theadHeight=a.tbodyTop-a.theadTop;f.length?(a.tfootTop=f.offset().top,a.tfootBottom=a.tfootTop+f.outerHeight(),a.tfootHeight=a.tfootBottom-a.tfootTop):(a.tfootTop=a.tbodyTop+e.outerHeight(),a.tfootBottom=a.tfootTop,a.tfootHeight=a.tfootTop)},_scroll:function(b){var a=d(document).scrollTop(),e=d(document).scrollLeft(),c=this.s.position,f;if(this.s.enable&&(this.c.header&&(f=!c.visible||a<=c.theadTop-this.c.headerOffset?"in-place":a<=c.tfootTop-
c.theadHeight-this.c.headerOffset?"in":"below",(b||f!==this.s.headerMode)&&this._modeChange(f,"header",b),this._horizontal("header",e)),this.c.footer&&this.dom.tfoot.length))a=!c.visible||a+c.windowHeight>=c.tfootBottom+this.c.footerOffset?"in-place":c.windowHeight+a>c.tbodyTop+c.tfootHeight+this.c.footerOffset?"in":"above",(b||a!==this.s.footerMode)&&this._modeChange(a,"footer",b),this._horizontal("footer",e)}});h.version="3.1.0-dev";h.defaults={header:!0,footer:!1,headerOffset:0,footerOffset:0};
d.fn.dataTable.FixedHeader=h;d.fn.DataTable.FixedHeader=h;d(document).on("init.dt.dtb",function(b,a){if("dt"===b.namespace){var e=a.oInit.fixedHeader||g.defaults.fixedHeader;e&&!a._fixedHeader&&new h(a,e)}});g.Api.register("fixedHeader()",function(){});g.Api.register("fixedHeader.adjust()",function(){return this.iterator("table",function(b){(b=b._fixedHeader)&&b.update()})});g.Api.register("fixedHeader.enable()",function(b){return this.iterator("table",function(a){(a=a._fixedHeader)&&a.enable(void 0!==
b?b:!0)})});g.Api.register("fixedHeader.disable()",function(){return this.iterator("table",function(b){(b=b._fixedHeader)&&b.enable(!1)})});d.each(["header","footer"],function(b,a){g.Api.register("fixedHeader."+a+"Offset()",function(b){var c=this.context;return void 0===b?c.length&&c[0]._fixedHeader?c[0]._fixedHeader[a+"Offset"]():void 0:this.iterator("table",function(c){if(c=c._fixedHeader)c[a+"Offset"](b)})})});return h});
